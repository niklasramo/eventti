"use strict";var o=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var l=(r,e)=>{for(var n in e)o(r,n,{get:e[n],enumerable:!0})},m=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of u(e))!p.call(r,i)&&i!==n&&o(r,i,{get:()=>e[i],enumerable:!(t=a(e,i))||t.enumerable});return r};var f=r=>m(o({},"__esModule",{value:!0}),r);var c={};l(c,{Emitter:()=>v,EmitterDedupe:()=>d});module.exports=f(c);var d={ADD:"add",UPDATE:"update",IGNORE:"ignore",THROW:"throw"},v=class{constructor(e={}){this.dedupe=e.dedupe||d.ADD,this.getId=e.getId||(()=>Symbol()),this._events=new Map}_getListeners(e){let n=this._events.get(e);return n?.m?.size?n.l||(n.l=[...n.m.values()]):null}on(e,n,t){let i=this._events,s=i.get(e);s||(s={m:new Map,l:null},i.set(e,s));let E=s.m;if(t=t===void 0?this.getId(n):t,E.has(t))switch(this.dedupe){case d.THROW:throw new Error("Eventti: duplicate listener id!");case d.IGNORE:return t;case d.UPDATE:{s.l=null;break}default:E.delete(t),s.l=null}return E.set(t,n),s.l?.push(n),t}once(e,n,t){let i=!1;return t=t===void 0?this.getId(n):t,this.on(e,(...s)=>{i||(i=!0,this.off(e,t),n(...s))},t)}off(e,n){if(e===void 0){this._events.clear();return}if(n===void 0){this._events.delete(e);return}let t=this._events.get(e);t&&t.m.delete(n)&&(t.l=null,t.m.size||this._events.delete(e))}emit(e,...n){let t=this._getListeners(e);if(t){let i=t.length,s=0;if(n.length)for(;s<i;s++)t[s](...n);else for(;s<i;s++)t[s]()}}listenerCount(e){if(e===void 0){let n=0;return this._events.forEach(t=>{n+=t.m.size}),n}return this._events.get(e)?.m.size||0}};0&&(module.exports={Emitter,EmitterDedupe});
