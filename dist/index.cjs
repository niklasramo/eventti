"use strict";var d=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var l=Object.prototype.hasOwnProperty;var m=(r,e)=>{for(var n in e)d(r,n,{get:e[n],enumerable:!0})},f=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of p(e))!l.call(r,i)&&i!==n&&d(r,i,{get:()=>e[i],enumerable:!(t=u(e,i))||t.enumerable});return r};var c=r=>f(d({},"__esModule",{value:!0}),r);var h={};m(h,{Emitter:()=>a,EmitterDedupe:()=>o});module.exports=c(h);var o={ADD:"add",UPDATE:"update",IGNORE:"ignore",THROW:"throw"},E,a=class{constructor(e={}){this.dedupe=e.dedupe||o.ADD,this.getId=e.getId||(()=>Symbol()),this._events=new Map}_getListeners(e){let n=this._events.get(e);return n?n.l||(n.l=[...n.m.values()]):null}on(e,n,t){let i=this._events,s=i.get(e);s||(s={m:new Map,l:null},i.set(e,s));let v=s.m;if(t=t===E?this.getId(n):t,v.has(t))switch(this.dedupe){case o.THROW:throw new Error("Eventti: duplicate listener id!");case o.IGNORE:return t;case o.UPDATE:{s.l=null;break}default:v.delete(t),s.l=null}return v.set(t,n),s.l?.push(n),t}once(e,n,t){let i=0;return t=t===E?this.getId(n):t,this.on(e,(...s)=>{i||(i=1,this.off(e,t),n(...s))},t)}off(e,n){if(e===E){this._events.clear();return}if(n===E){this._events.delete(e);return}let t=this._events.get(e);t?.m.delete(n)&&(t.l=null,t.m.size||this._events.delete(e))}emit(e,...n){let t=this._getListeners(e);if(t){let i=t.length,s=0;if(n.length)for(;s<i;s++)t[s](...n);else for(;s<i;s++)t[s]()}}listenerCount(e){if(e===E){let n=0;return this._events.forEach(t=>{n+=t.m.size}),n}return this._events.get(e)?.m.size||0}};0&&(module.exports={Emitter,EmitterDedupe});
